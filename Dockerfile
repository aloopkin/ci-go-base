ARG BASE_IMAGE_TAG
FROM debian:bullseye-slim

USER root

RUN \
  echo "deb http://deb.debian.org/debian bullseye-backports main" >> /etc/apt/sources.list && \
  apt update && \
  apt install -y npm aspell aspell-en asciidoctor python3 python3-pip curl ca-certificates golang-1.19-go bundler openssl xxd && \
  ln -s /usr/lib/go-1.19/bin/go /usr/bin/go && \
  ln -s /usr/lib/go-1.19/bin/gofmt /usr/bin/gofmt && \  
  gem install hexapdf && \
  gem install rouge && \
  gem install asciidoctor-pdf && \
  npm install -g asciidoc-link-check && \
  pip install pyspelling && \
  pip install lemoncheesecake[junit] && \
  apt-get clean && \
  rm -rf /var/lib/apt/lists/*

RUN echo "3082057830820360a00302010202084c333c5cd84570a5300d06092a864886f70d01010b05003040310b300906035504061302465231123010060355040a1309457665725472757374311d301b0603550403131445766572547275737420514120526f6f74204341301e170d3230303231383030303030305a170d3430303231373233353935395a3040310b300906035504061302465231123010060355040a1309457665725472757374311d301b0603550403131445766572547275737420514120526f6f7420434130820222300d06092a864886f70d01010105000382020f003082020a0282020100bb6f7d730d5c14dc463509903c5c9596b2cacd618d72e2e79f7a5f0dbcfcd927942c94d179f8b5925d980c187b15b003111992e1674c39f1553803cd0e1ea04b900078d801d9097bc278001f8d92703c719b32a7c6d27fd41b10560864a4e8c6d075f5554b3deb729727cbea278f686cc2d415b8040f3e3a5f08bba094035c4e5c92f8b057dd6c584f43b43396149e6d12683ea636af2e04488bead8de53bac04f4bf182e637eba05e17734200bed28e3961495ed8ff788e1bb3fbcd756f0e280ddebf505195f6d48839298f7aad329b639fe30da9d6c1f3e888b247f5518cd2e008af6bef2bed072ea697b2644fbd28f31086338cc1d57d185116deb1177dc6d8fe422cdef944b8df1485019af3bfefcaff74d1b5632a07a4448f733480fa1913248958391aef6108a16b143c68a3b02d6189eb9de1e51d1323fe55865b719267aa7c80df696fb4d9b4adfe41303ebabce9c35f5070a34b3dbc18533e080100e215e75e9bc8885fe659ecc835ed167cd91acc32317f7f9e90cd8d97f74a239b5688b5421b0fac54c51a3b0ae882631361a2fc86ea3c460a3f88a4cd3b4920e95122fe1b4ad49bb1032f85bd0aa54a9ce825ecde477df96b82f797a82604b1d20bcf9c1579828852359663e04c349bdc268818bb385c52a6db18e58152f2aabadf80f2fc25361c47629560357d02838a283c8d1621138a5851b20e5b1facc0550203010001a3763074300f0603551d130101ff040530030101ff301d0603551d0e04160414b5c9e8e51f808d7e5e134f193ac0d861e1c5833c301f0603551d23041830168014b5c9e8e51f808d7e5e134f193ac0d861e1c5833c300e0603551d0f0101ff04040302010630110603551d20040a300830060604551d2000300d06092a864886f70d01010b0500038202010033850cc09b9a8cd183ba8987dbb1a880788cc67d14d6036b6afd87e755acd4a7ed84659cda4ffe09d20aece009167f2092e6556c84929925af03220cd9d5e9ca54bf92ce65f91b4cd0d6e81229b67abd45ee09eb029c3bc2ec0a7e472c657a55091ba121c0fa69eeda29d4bfc553ed1dfa037f8ebfbce76bf665fda341c2b339f72211001b792fe56ef4e2e04d12b5e2cc6d12716d992b597cd14bccfc74f19f98d82e24e721b5b2b8bbb363bf815a12a8c0951c9c519f51c4b1166573d4ab4fe9fac7b32f46f98466be5b3b1919c761b17f104f36a112bf9a568997b0eaaa930db8130ed7aeb11bffe6f71ceb6a5aa89141fd890a35dc3a7fbfe63b59795e6bb27d1e3a82ee826487d3b97d122b9bf69394f1fbf691e1255b559d89f429ea35c538bbb403bab4cf2c4458c6f61f230ec18e65954f242f5ff8100c0a1e5b835a29a64a7d8ebd69cfad23f01c88441fbebdb4f171b69f6e9ac921a94380de3eb795e1091f6845d520b534f9099eee5257f2b575c8845b0675a83f9c84ae1d9b25a61bc83be256fc813ca502fb7ae901aa583d2bc03d95dcb6d3a306dbfde92d5806d6d0fef2bb03d263c40b8a26ea8a8aa9ba9a0d361a8eed0c9ce6aadba55c539dce4731a959c72e6fb8a036339c167935c8671dd87860d76b31eb7753ddf37c63f85bb9242f365e2d8747fbe603df5078af5514aabac1e200fd73bff2c68b60" | xxd -r -p | openssl x509 -inform DER> /usr/local/share/ca-certificates/qa-rca.crt && \
  cat /usr/local/share/ca-certificates/qa-rca.crt && \
  update-ca-certificates
